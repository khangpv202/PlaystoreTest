name: "Close issue"

inputs:
  number:
    required: true
  title:
    required: true
  comments:
    required: false

description: Close issue if tag exists
runs:
  using: "composite"
  steps:
    - run: |
        curl \
          -X PATCH \
          -H 'Accept: application/vnd.github.v3+json' \
          -H "Authorization: token ${{ env.GITHUB_TOKEN }}" \
          -H "Content-Type: application/json" \
          https://api.github.com/repos/${{ github.repository }}/issues/${{ inputs.number }} \
          -d '{"state":"closed", "title":"Invalid ${{ inputs.title }}", "labels":["invalid"]}'
      shell: bash
    - if: ${{ inputs.comments }}
      run: |
        curl \
          -X POST \
          -H "Accept: application/vnd.github.v3+json" \
          -H "Authorization: token ${{ env.GITHUB_TOKEN }}" \
          https://api.github.com/repos/${{ github.repository }}/issues/${{ inputs.number }}/comments \
          -d '{"body":"${{ inputs.comments }}"}'
      shell: bash